# Submit a review and rating
Function SubmitReview:
    If request body is invalid:
        Return HTTP 400 Bad Request with message "Invalid request body"

    If rating is invalid OR productID is missing:
        Return HTTP 400 Bad Request with message "Invalid rating or product ID"

    result = saveReview(userID, productID, rating, reviewText)
    If result is error:
        Return HTTP 500 Internal Server Error with message "Failed to submit review"

    Return HTTP 201 Created with message "Review submitted"






# Get all reviews for a product
Function GetProductReviews(productID):
    If productID is invalid or missing:
        Return HTTP 400 Bad Request with message "Invalid product ID"

    reviews = fetchReviewsByProductID(productID)
    If error while fetching:
        Return HTTP 500 Internal Server Error with message "Failed to retrieve reviews"

    Return HTTP 200 OK with data: reviews






# Get current user's reviews
Function GetUserReviews:
    If userID is missing:
        Return HTTP 401 Unauthorized with message "User not authenticated"

    reviews = fetchReviewsByUserID(userID)
    If error while fetching:
        Return HTTP 500 Internal Server Error with message "Failed to retrieve user reviews"

    Return HTTP 200 OK with data: reviews






# Update a review
Function UpdateReview(reviewID):
    If request body is invalid:
        Return HTTP 400 Bad Request with message "Invalid request body"

    review = fetchReviewByID(reviewID)
    If review not found OR review.userID != currentUserID:
        Return HTTP 403 Forbidden with message "Not authorized to update this review"

    result = updateReview(reviewID, newRating, newReviewText)
    If result is error:
        Return HTTP 500 Internal Server Error with message "Failed to update review"

    Return HTTP 200 OK with message "Review updated"






# Delete a review
Function DeleteReview(reviewID):
    review = fetchReviewByID(reviewID)
    If review not found OR review.userID != currentUserID:
        Return HTTP 403 Forbidden with message "Not authorized to delete this review"

    result = deleteReview(reviewID)
    If result is error:
        Return HTTP 500 Internal Server Error with message "Failed to delete review"

    Return HTTP 200 OK with message "Review deleted"






# Get average rating and count
Function GetProductRatingSummary(productID):
    If productID is invalid or missing:
        Return HTTP 400 Bad Request with message "Invalid product ID"

    data = calculateAverageRating(productID)
    If error while fetching data:
        Return HTTP 500 Internal Server Error with message "Failed to calculate rating summary"

    Return HTTP 200 OK with data: { average_rating, total_reviews }
